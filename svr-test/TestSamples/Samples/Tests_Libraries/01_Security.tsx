<?xml version="1.0" encoding="utf-8" ?>
<file>
<properties><parameters /><probes><probe><active>False</active><args /><name>probe01</name><type>default</type></probe></probes><agents><agent><value>agent-socket01</value><description /><name>AGENT</name><type /></agent></agents><descriptions><description><value>admin</value><key>author</key></description><description><value>23/09/2012</value><key>creation date</key></description><description><value>Just a basic sample.</value><key>summary</key></description><description><value>None.</value><key>prerequisites</key></description><description><value><comments /></value><key>comments</key></description><description><value>myplugins</value><key>libraries</key></description><description><value>myplugins</value><key>adapters</key></description><description><value>Writing</value><key>state</key></description><description><value>REQ_01</value><key>requirement</key></description></descriptions><outputs-parameters><parameter><value>1.0</value><description /><name>TIMEOUT</name><type>float</type><scope>local</scope></parameter></outputs-parameters><inputs-parameters><parameter><value>-----BEGIN CERTIFICATE-----
MIIHKjCCBhKgAwIBAgIQDnd2il0H8OV5WcoqnVCCtTANBgkqhkiG9w0BAQUFADBp
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSgwJgYDVQQDEx9EaWdpQ2VydCBIaWdoIEFzc3VyYW5j
ZSBFViBDQS0xMB4XDTExMDUyNzAwMDAwMFoXDTEzMDcyOTEyMDAwMFowgcoxHTAb
BgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRMwEQYLKwYBBAGCNzwCAQMTAlVT
MRswGQYLKwYBBAGCNzwCAQITCkNhbGlmb3JuaWExETAPBgNVBAUTCEMzMjY4MTAy
MQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNU2Fu
IEZyYW5jaXNjbzEVMBMGA1UEChMMR2l0SHViLCBJbmMuMRMwEQYDVQQDEwpnaXRo
dWIuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7dOJw11wcgnz
M08acnTZtlqVULtoYZ/3+x8Z4doEMa8VfBp/+XOvHeVDK1YJAEVpSujEW9/Cd1JR
GVvRK9k5ZTagMhkcQXP7MrI9n5jsglsLN2Q5LLcQg3LN8OokS/rZlC7DhRU5qTr2
iNr0J4mmlU+EojdOfCV4OsmDbQIXlXh9R6hVg+4TyBkaszzxX/47AuGF+xFmqwld
n0xD8MckXilyKM7UdWhPJHIprjko/N+NT02Dc3QMbxGbp91i3v/i6xfm/wy/wC0x
O9ZZovLdh0pIe20zERRNNJ8yOPbIGZ3xtj3FRu9RC4rGM+1IYcQdFxu9fLZn6TnP
pVKACvTqzQIDAQABo4IDajCCA2YwHwYDVR0jBBgwFoAUTFjLJfBBT1L0KMiBQ5um
qKDmkuUwHQYDVR0OBBYEFIfRjxlu5IdvU4x3kQdQ36O/VUcgMCUGA1UdEQQeMByC
CmdpdGh1Yi5jb22CDnd3dy5naXRodWIuY29tMIGBBggrBgEFBQcBAQR1MHMwJAYI
KwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBLBggrBgEFBQcwAoY/
aHR0cDovL3d3dy5kaWdpY2VydC5jb20vQ0FDZXJ0cy9EaWdpQ2VydEhpZ2hBc3N1
cmFuY2VFVkNBLTEuY3J0MAwGA1UdEwEB/wQCMAAwYQYDVR0fBFowWDAqoCigJoYk
aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL2V2MjAwOWEuY3JsMCqgKKAmhiRodHRw
Oi8vY3JsNC5kaWdpY2VydC5jb20vZXYyMDA5YS5jcmwwggHEBgNVHSAEggG7MIIB
tzCCAbMGCWCGSAGG/WwCATCCAaQwOgYIKwYBBQUHAgEWLmh0dHA6Ly93d3cuZGln
aWNlcnQuY29tL3NzbC1jcHMtcmVwb3NpdG9yeS5odG0wggFkBggrBgEFBQcCAjCC
AVYeggFSAEEAbgB5ACAAdQBzAGUAIABvAGYAIAB0AGgAaQBzACAAQwBlAHIAdABp
AGYAaQBjAGEAdABlACAAYwBvAG4AcwB0AGkAdAB1AHQAZQBzACAAYQBjAGMAZQBw
AHQAYQBuAGMAZQAgAG8AZgAgAHQAaABlACAARABpAGcAaQBDAGUAcgB0ACAAQwBQ
AC8AQwBQAFMAIABhAG4AZAAgAHQAaABlACAAUgBlAGwAeQBpAG4AZwAgAFAAYQBy
AHQAeQAgAEEAZwByAGUAZQBtAGUAbgB0ACAAdwBoAGkAYwBoACAAbABpAG0AaQB0
ACAAbABpAGEAYgBpAGwAaQB0AHkAIABhAG4AZAAgAGEAcgBlACAAaQBuAGMAbwBy
AHAAbwByAGEAdABlAGQAIABoAGUAcgBlAGkAbgAgAGIAeQAgAHIAZQBmAGUAcgBl
AG4AYwBlAC4wHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMBEGCWCGSAGG
+EIBAQQEAwIGwDAOBgNVHQ8BAf8EBAMCBaAwDQYJKoZIhvcNAQEFBQADggEBABRS
cR+GnW01Poa7ZhqLhZi5AEzLQrVG/AbnRDnI6FLYERQjs3KW6RSUni8AKPfVBEVA
AMb0V0JC3gmJlxENFFxrvQv3GKNfZwLzCThjv8ESnTC6jqVUdFlTZ6EbUFsm2v0T
flkXv0nvlH5FpP06STLwav+JjalhqaqblkbIHOAYHOb7gvQKq1KmyuhUItnbKj1a
InuA6gcF1PnH8FNZX7t3ft6TcEFOI8t4eXnELurXZioY99HFfOISeIKNHeyCngGi
5QK+eKG5WVjFTG9PpTG0SVtemB4uOPYZxDmiSvt5BbjyWeUmEnCtwOh1Ix8Y0Qvg
n2Xkw9dJh1tybLEvrG8=
-----END CERTIFICATE-----</value><description /><name>CERT</name><type>text</type><color /><scope>local</scope></parameter><parameter><value>/opt/xtc/current/Scripts/ca.crt</value><description /><name>CERT_PATH</name><type>str</type><color /><scope>local</scope></parameter><parameter><value>False</value><description /><name>DEBUG</name><type>bool</type><color>#000000</color><scope>local</scope></parameter><parameter><value>secret2</value><description /><name>HMAC_KEY</name><type>str</type><color /><scope>local</scope></parameter><parameter><value>eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.EkN-DOsnsuRjRO6BxXemmJDm3HbxrbRzXglbN2S4sOkopdU4IsDxTI8jO19W_A4K8ZPJijNLis4EZsHeY559a4DFOd50_OqgHGuERTqYZyuhtF39yxJPAjUESwxk2J5k_4zM3O-vtd1Ghyo4IbqKKSy6J9mTniYJPenn5-HIirE</value><description /><name>JWT_TOKEN</name><type>text</type><color /><scope>local</scope></parameter><parameter><value>-----BEGIN RSA PRIVATE KEY-----
MIICWwIBAAKBgQDdlatRjRjogo3WojgGHFHYLugdUWAY9iR3fy4arWNA1KoS8kVw33cJibXr8bvwUAUparCwlvdbH6dvEOfou0/gCFQsHUfQrSDv+MuSUMAe8jzKE4qW+jK+xQU9a03GUnKHkkle+Q0pX/g6jXZ7r1/xAK5Do2kQ+X5xK9cipRgEKwIDAQABAoGAD+onAtVye4ic7VR7V50DF9bOnwRwNXrARcDhq9LWNRrRGElESYYTQ6EbatXS3MCyjjX2eMhu/aF5YhXBwkppwxg+EOmXeh+MzL7Zh284OuPbkglAaGhV9bb6/5CpuGb1esyPbYW+Ty2PC0GSZfIXkXs76jXAu9TOBvD0ybc2YlkCQQDywg2R/7t3Q2OE2+yo382CLJdrlSLVROWKwb4tb2PjhY4XAwV8d1vy0RenxTB+K5Mu57uVSTHtrMK0GAtFr833AkEA6avx20OHo61Yela/4k5kQDtjEf1N0LfI+BcWZtxsS3jDM3i1Hp0KSu5rsCPb8acJo5RO26gGVrfAsDcIXKC+bQJAZZ2XIpsitLyPpuiMOvBbzPavd4gY6Z8KWrfYzJoI/Q9FuBo6rKwl4BFoToD7WIUS+hpkagwWiz+6zLoX1dbOZwJACmH5fSSjAkLRi54PKJ8TFUeOP15h9sQzydI8zJU+upvDEKZsZc/UhT/SySDOxQ4G/523Y0sz/OZtSWcol/UMgQJALesy++GdvoIDLfJX5GBQpuFgFenRiRDabxrE9MNUZ2aPFaFp+DyAe+b4nDwuJaW2LURbr8AEZga7oQj0uYxcYw==
-----END RSA PRIVATE KEY-----</value><description /><name>PRIVATE_KEY</name><type>text</type><color /><scope>local</scope></parameter><parameter><value>-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDdlatRjRjogo3WojgGHFHYLugdUWAY9iR3fy4arWNA1KoS8kVw33cJibXr8bvwUAUparCwlvdbH6dvEOfou0/gCFQsHUfQrSDv+MuSUMAe8jzKE4qW+jK+xQU9a03GUnKHkkle+Q0pX/g6jXZ7r1/xAK5Do2kQ+X5xK9cipRgEKwIDAQAB
-----END PUBLIC KEY-----</value><description /><name>PUBLIC_KEY</name><type>text</type><color /><scope>local</scope></parameter><parameter><value>1.0</value><description /><name>TIMEOUT</name><type>float</type><color>#000000</color><scope>local</scope></parameter></inputs-parameters></properties>
<testdefinition><![CDATA[
class AUTHENTICATION_DIGEST_01(TestCase):
	def description(self):
		self.step1 = self.addStep(expected="ok", description="set as pass", summary="set as pass", enabled=True)	
	def prepare(self):
		self.auth = SutLibraries.Authentication.Digest(parent=self, debug=get('DEBUG'))
	def cleanup(self, aborted):
		pass
	def definition(self):
		self.step1.start()

		authent = 'Digest realm="panic", nonce="MMv6mVzKBAA=ceb6c717459f813001fc53eb7e392ad0f230cf54", algorithm=MD5, qop="auth"'
		self.info( authent )
		
		decoded = self.auth.decode(challenge=authent)
		self.info( decoded )
		
		challenge = self.auth.compute( 
																		username='code', password='code_2011', 
																		realm=decoded['realm'], nonce=decoded['nonce'], 
																		method='GET', uri='/', 
																		qop=decoded['qop'], algo=decoded['algorithm']
																	)
		self.info( challenge )
		digest, cnonce, nc = challenge
		
		encoded = self.auth.encode(
																		username='code', realm=decoded['realm'],
																		nonce=decoded['nonce'], uri='/', response=digest,
																		cnonce=cnonce, nc=nc, qop=decoded['qop'],
																		algo=decoded['algorithm'], opaque=None
																	)
		self.info( encoded )
		
		self.step1.setPassed(actual="pass")

class AUTHENTICATION_BASIC_01(TestCase):
	def description(self):
		self.step1 = self.addStep(expected="ok", description="set as pass", summary="set as pass", enabled=True)
	def prepare(self):
		self.auth = SutLibraries.Authentication.Basic(parent=self, debug=get('DEBUG'))
	def cleanup(self, aborted):
		pass
	def definition(self):
		self.step1.start()

		authent = 'Basic realm="test"'
		self.info( authent )
		
		decoded = self.auth.decode(challenge=authent)
		self.info( decoded )
		
		challenge = self.auth.compute( username='admin', password='admin' )
		self.info( challenge )
		

		encoded = self.auth.encode( response=challenge )
		self.info( encoded )
		
		self.step1.setPassed(actual="pass")
		
class AUTHENTICATION_OAUTH_01(TestCase):
	def description(self):
		self.step1 = self.addStep(expected="ok", description="set as pass", summary="set as pass", enabled=True)
	def prepare(self):
		self.auth = SutLibraries.Authentication.Oauth(parent=self, debug=get('DEBUG'))
	def cleanup(self, aborted):
		pass
	def definition(self):
		self.step1.start()

		oauth_method = 'POST'
		oauth_url = 'https://api/oauth'
		oauth_callback="oob"
		oauth_nonce='9307e873fc12c982ae837887eec955d3'
		oauth_signature_method='HMAC-SHA1'
		oauth_timestamp='1413141560'
		oauth_consumer_key = 'giiLUy7hPxxxxxxx'
		oauth_consumer_secret = 'gPAFhHu19h6LWTyk9ZAexxxxxxxxxxx'
		oauth_signature = ''
		oauth_version = '1.0'
	
		parameters = [
								('oauth_nonce', oauth_nonce),
								('oauth_callback', oauth_callback),
								('oauth_signature_method', 'HMAC-SHA1'),
								('oauth_timestamp', oauth_timestamp),
								('oauth_consumer_key', oauth_consumer_key),
								('oauth_version', '1.0')
		]
		oauth_signature = self.auth.compute( parameters=parameters, url=oauth_url, method=oauth_method, tokenSecret='', consumerSecret=oauth_consumer_secret )
		self.info( oauth_signature )
		

		encoded = self.auth.encode( nonce=oauth_nonce, callback=oauth_callback, method=oauth_method, timestamp=oauth_timestamp, 
																							consumerkey=oauth_consumer_key, signature=oauth_signature, version=oauth_version )
		self.info( encoded )
		
		self.step1.setPassed(actual="pass")
		

class CERT_01(TestCase):
	def description(self):
		self.setPurpose(purpose=description('summary'))
		self.setRequirement(requirement=description('requirement'))

		# steps description
		self.step1 = self.addStep(expected="result expected", description="step description", summary="step sample", enabled=True)
	def prepare(self):
		self.LIB_CERT = SutLibraries.Security.Certificate(parent=self, name=None, debug=False, shared=False)
		
	def definition(self):
		# starting initial step
		if self.step1.isEnabled():
			self.step1.start()
			
			s = self.LIB_CERT.toHuman(certPath=input('CERT_PATH'))
			self.warning( "%s" % s, raw=True)
			
			s = self.LIB_CERT.toHuman(cert=input('CERT'))
			self.warning( "%s" % s, raw=True)
			
			d = self.LIB_CERT.decode(cert=input('CERT'))
			self.warning( "%s" % d, raw=True)
		
			self.step1.setPassed(actual="success")

	def cleanup(self, aborted):
		pass

class JWT_01(TestCase):
	def description(self):
		self.setPurpose(purpose=description('summary'))
		self.setRequirement(requirement=description('requirement'))

		# steps description
		self.step1 = self.addStep(expected="result expected", description="step description", summary="step sample", enabled=True)
	def prepare(self):
		self.LIB_JWT= SutLibraries.Security.JWT(parent=self, name=None, debug=False, shared=False)

	def definition(self):
		# starting initial step
		if self.step1.isEnabled():
			self.step1.start()

			# decode jwt
			self.info("decode jwt and verify signature")
			hdr, pl, valid = self.LIB_JWT.decode(token=input('JWT_TOKEN'), verify=True, key=input('PUBLIC_KEY'))
			self.warning( "Header=%s\nPayload=%s\nValid=%s" % (hdr, pl, valid) )
	
			# encode jwt
			self.info("encode jwt and sign it with the private key")
			encoded = self.LIB_JWT.encode(payload=pl, alg="RS256", key=input('PRIVATE_KEY'))
			self.warning( "%s" % str(encoded) )
			
			self.info("decode again jwt and verify signature")
			hdr2, pl2, valid2 = self.LIB_JWT.decode(token=encoded, verify=True, key=input('PUBLIC_KEY'))
			self.warning( "Header=%s\nPayload=%s\nValid=%s" % (hdr2, pl2, valid2) )
			
			self.info("create token from scratch rs256")
			token_pl = { "sub": "1234567890", "name": "Denis", "admin": False }
			encoded2 = self.LIB_JWT.encode(payload=token_pl, alg="RS256", key=input('PRIVATE_KEY'))
			self.warning( "%s" % str(encoded2) )
			
			self.info("create token from scratch hs256")
			token_pl = { "sub": "1234567890", "name": "Denis", "admin": False }
			encoded2 = self.LIB_JWT.encode(payload=token_pl, alg="HS256", key=input('HMAC_KEY'))
			self.warning( "%s" % str(encoded2) )
			
			self.info("decode again jwt and verify signature")
			hdr2, pl2, valid2 = self.LIB_JWT.decode(token=encoded2, verify=True, key=input('HMAC_KEY'))
			self.warning( "Header=%s\nPayload=%s\nValid=%s" % (hdr2, pl2, valid2) )
			
			self.step1.setPassed(actual="success")

	def cleanup(self, aborted):
		pass

]]></testdefinition>
<testexecution><![CDATA[
AUTHENTICATION_DIGEST_01(suffix=None).execute()
AUTHENTICATION_BASIC_01(suffix=None).execute()
AUTHENTICATION_OAUTH_01(suffix=None).execute()

CERT_01(suffix=None).execute()
JWT_01(suffix=None).execute()]]></testexecution>
<testdevelopment>1413440041.47</testdevelopment>
</file>